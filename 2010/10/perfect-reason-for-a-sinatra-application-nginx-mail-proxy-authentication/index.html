<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/2010/styles.742409eb857ab2ccca34.css" data-identity="gatsby-global-css">li{margin-right:1rem}h1,li{display:inline-block}h1{font-style:normal;margin-top:0}header{margin-bottom:1.5rem}header ul{float:right;list-style:none}#wrapper{margin:3em auto;max-width:700px;padding:10px}.blogPostDate{color:#333;font-size:8pt;margin-bottom:9px;padding-top:4px}</style><meta name="generator" content="Gatsby 4.4.0"/><title data-react-helmet="true">Perfect Reason for a Sinatra Application NGINX Mail Proxy Authentication</title><link data-react-helmet="true" rel="canonical" href="https://www.docunext.com/2010/10/perfect-reason-for-a-sinatra-application-nginx-mail-proxy-authentication/"/><link as="script" rel="preload" href="/2010/webpack-runtime-64714893fad3d6616b95.js"/><link as="script" rel="preload" href="/2010/framework-3b46cba0dfed09aeeb64.js"/><link as="script" rel="preload" href="/2010/app-00c377d84359908eff43.js"/><link as="script" rel="preload" href="/2010/commons-07a951b24cae11aa6a48.js"/><link as="script" rel="preload" href="/2010/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js"/><link as="fetch" rel="preload" href="/2010/page-data/2010/10/perfect-reason-for-a-sinatra-application-nginx-mail-proxy-authentication/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/2010/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/2010/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="wrapper"><header><ul><li><a href="/about/">About</a></li></ul><a href="/"><h1>Docunext</h1></a></header><hr/><div><h2>Perfect Reason for a Sinatra Application NGINX Mail Proxy Authentication</h2><div class="blogPostDate">October 5th, 2010</div><div><p>I am a big fan of Sinatra, the adept development framework for building small and tight web applications.</p>
<p>So recently when I was setting up <a href="http://www.docunext.com/">Dovecot</a> with LDAP authentication on an <a href="http://www.docunext.com/wiki/OpenVZ">OpenVZ virtual server</a>, I gave the <a href="http://www.docunext.com/wiki/NGINX">NGINX</a> IMAP proxy a try.</p>
<p>While I got it working, I found the authentication module a bit clunky at first. It passes credentials from the user to an authentication system using HTTP, expecting HTTP headers back about whether the users' credentials were legitimate and where to proxy their connection.</p>
<p>After I tried out an example PHP authentication mechanism, it made more sense. NGINX is a web server, too! Its super simple, and I wouldn't mind seeing more authentication mechanisms like this. Here's how it works (examples are from the NGINX wiki):</p>
<p><strong>Request</strong>:</p>
<pre class="sh_sh">
GET /auth HTTP/1.0
Host: auth.server.hostname
Auth-Method: plain
Auth-User: user
Auth-Pass: password
Auth-Protocol: imap
Auth-Login-Attempt: 1
Client-IP: 192.168.1.1
</pre>
<p><strong>Response</strong>:</p>
<pre class="sh_sh">
HTTP/1.0 200 OK
Auth-Status: OK
Auth-Server: 192.168.1.10
Auth-Port: 143
Auth-User: newname
Auth-Pass: newpassword
</pre>
<p>Seeing how much I dig Sinatra, how about a Sinatra application that proxies this simple HTTP authentication mechanism to a SASL mechanism?</p>
<p>The NGINX mail authentication mechanism is actually more sophisticated than the basic HTTP authentication module because it supports CRAM-MD5 which some e-mail clients support.</p>
<p>If only NGINX supported authorization via digest authentication like this using an HTTP request to handle the actual authentication - that would be so cool!! It might even compete with the fact that Apache can use digest authentication via a MySQL/Postgres/SQLite backend!</p>
<p>¥</p></div></div><div><span>Yearly Indexes: </span><span><a href="/2003"><span>2003</span></a> </span><span><a href="/2004"><span>2004</span></a> </span><span><a href="/2006"><span>2006</span></a> </span><span><a href="/2007"><span>2007</span></a> </span><span><a href="/2008"><span>2008</span></a> </span><span><a href="/2009"><span>2009</span></a> </span><span><a href="/2010"><span>2010</span></a> </span><span><a href="/2011"><span>2011</span></a> </span><span><a href="/2012"><span>2012</span></a> </span><span><a href="/2013"><span>2013</span></a> </span><span><a href="/2015"><span>2015</span></a> </span><span><a href="/2019"><span>2019</span></a> </span><span><a href="/2020"><span>2020</span></a> </span><span><a href="/2022"><span>2022</span></a> </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2010/10/perfect-reason-for-a-sinatra-application-nginx-mail-proxy-authentication/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4633e8f6cc7cf1607dae.js"],"app":["/app-00c377d84359908eff43.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a8b57182e60688a12d91.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js"],"component---src-templates-year-js":["/component---src-templates-year-js-0397176bed9177a29771.js"]};/*]]>*/</script><script src="/2010/polyfill-4633e8f6cc7cf1607dae.js" nomodule=""></script><script src="/2010/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js" async=""></script><script src="/2010/commons-07a951b24cae11aa6a48.js" async=""></script><script src="/2010/app-00c377d84359908eff43.js" async=""></script><script src="/2010/framework-3b46cba0dfed09aeeb64.js" async=""></script><script src="/2010/webpack-runtime-64714893fad3d6616b95.js" async=""></script></body></html>